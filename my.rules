alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"APP-DETECT Acunetix web vulnerability scanner base64 XSS attempt"; flow:to_server,established; http_uri; content:"PHNjcmlwdD",fast_pattern,nocase; metadata:policy max-detect-ips drop,ruleset community; service:http; reference:url,www.acunetix.com; classtype:web-application-attack; sid:25362; rev:3; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"APP-DETECT Acunetix web vulnerability scanner prompt XSS attempt"; flow:to_server,established; http_uri; content:"<ScRiPt>prompt(",fast_pattern,nocase; metadata:policy max-detect-ips drop,ruleset community; service:http; reference:url,www.acunetix.com; classtype:web-application-attack; sid:25364; rev:3; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"APP-DETECT Acunetix web vulnerability scanner XSS attempt"; flow:to_server,established; http_uri; content:">=|5C|xa2",fast_pattern,nocase; metadata:policy max-detect-ips drop,ruleset community; service:http; reference:url,www.acunetix.com; classtype:web-application-attack; sid:25365; rev:3; )
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:"BROWSER-CHROME Google Chrome net-internals uri fragment identifier XSS attempt"; flow:established,to_client; file_data; content:"chrome://net-internals/view-cache/",nocase; pcre:"/^\x23([\x22\x27\x3c\x3e\x28\x29]|script|onload|src)/iR"; metadata:policy max-detect-ips drop; service:http; reference:bugtraq,39667; reference:cve,2010-1503; reference:url,code.google.com/p/chromium/issues/detail?id=40137; classtype:attempted-user; sid:23471; rev:6; )
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:"BROWSER-CHROME Google Chrome XSSAuditor filter security policy bypass attempt"; flow:to_client,established; file_data; content:"<iframe",nocase; content:"srcdoc",within 20,nocase; content:"<script>",within 10,nocase; pcre:"/<iframe[^>]*?srcdoc\s?=\s?[\x22\x27]<script>/smi"; metadata:policy max-detect-ips drop; service:http; reference:bugtraq,65066; reference:url,blog.elevenpaths.com/2014/01/how-to-bypass-antixss-filter-in-chrome.html; reference:url,googlechromereleases.blogspot.ca/2014/01/stable-channel-update.html; reference:url,trac.webkit.org/changeset/158676; classtype:attempted-user; sid:30252; rev:3; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"BROWSER-CHROME Google Chrome XSSAuditor Policy ByPass command injection attempt"; flow:to_server,established; http_client_body; content:"%3Csvg%3E%",fast_pattern,nocase; content:"%3Cscript%3E"; pkt_data; pcre:"/(%2F|\/|\x2f)(%3c|\x3c|\<)/i"; metadata:policy max-detect-ips drop; service:http, ssl; reference:url,codereview.chromium.org/1187843005/; reference:url,vulnerable.info/browsers/bypassing-chromes-anti-xss-filter/; classtype:attempted-user; sid:35411; rev:3; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"BROWSER-CHROME Google Chrome xssauditor policy bypass command injection attempt"; flow:to_server,established; http_uri; content:"<svg>",fast_pattern,nocase; content:"<script>"; content:"/<",distance 0; metadata:policy max-detect-ips drop; service:http, ssl; reference:url,codereview.chromium.org/1187843005/; reference:url,vulnerable.info/browsers/bypassing-chromes-anti-xss-filter/; classtype:attempted-user; sid:35412; rev:3; )
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:"BROWSER-IE Microsoft Internet Explorer toStaticHTML XSS attempt"; flow:to_client,established; file_data; content:"toStaticHTML",nocase; pcre:"/toStaticHtml\s*\x28[^\x29]*?<\s*style\s*>.*?[&\x22<>]\s*\w+[\x3a=].*?\x29\x3b/i"; metadata:policy max-detect-ips drop; service:http; reference:cve,2011-1252; reference:url,technet.microsoft.com/en-us/security/bulletin/ms11-074; classtype:web-application-activity; sid:21569; rev:6; )
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:"BROWSER-IE Microsoft Internet Explorer XSS mouseevent PII disclosure attempt"; flow:to_client,established; file_data; content:"setcapture|28 29|",fast_pattern,nocase; content:"onclick=",nocase; content:"event",nocase; content:"srcelement.",distance 0,nocase; pcre:"/(?P<divname>\w+)\x2esetcapture\x28\x29.*?<div[^\x3e]*?(?P=divname)[^\x3e]*?onclick\x3d/smi"; metadata:policy max-detect-ips drop; service:http; reference:cve,2008-3473; reference:url,technet.microsoft.com/en-us/security/bulletin/MS08-053; classtype:web-application-activity; sid:14656; rev:13; )
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:"BROWSER-IE Microsoft Internet Explorer 8 toStaticHTML XSS attempt"; flow:to_client,established; file_data; content:"toStaticHTML(",fast_pattern,nocase; content:"expression(",within 100,nocase; pcre:"/toStaticHTML\x28.*?[\x26\x22].=expression\x28/smi"; metadata:policy max-detect-ips drop; service:http; reference:cve,2011-1252; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-050; classtype:attempted-user; sid:19239; rev:7; )
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:"BROWSER-IE Microsoft Internet Explorer XSRF timing attack against XSS filter"; flow:to_client,established; file_data; content:"onload",nocase; content:"timeCount",nocase; content:"tcInterval",nocase; content:"setInterval",nocase; pcre:"/iframe.*?id\s*\x3d\s*(?P<q1>\w*)\s*src\s*\x3d\s*.*?(?P=q1)\x2elocation\s*\x3d\s*(?P<q2>\x22|\x27|)\s*(http|https)\x3a\x2f\x2f.*?(?P=q2)/smi"; metadata:policy max-detect-ips drop; service:http; reference:cve,2011-1992; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-089; classtype:attempted-recon; sid:20699; rev:8; )
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:"BROWSER-IE Microsoft Internet Explorer 8 XSS in toStaticHTML API attempt"; flow:to_client,established; file_data; content:"toStaticHTML"; content:"style",distance 0; pcre:"/toStaticHTML\x28\x22\x3cstyle\x3e\x2a.*\x5bx=(\x27|&39)\x3b/si"; metadata:policy max-detect-ips drop; service:http; reference:cve,2010-3243; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-071; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-072; classtype:attempted-user; sid:17766; rev:15; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"BROWSER-IE Microsoft Internet Explorer invalid Shift_JIS character xss attempt"; flow:to_client,established; file_data; content:"<input value=",fast_pattern,nocase; pcre:"/<input value=[\x22\x27][\x80-\xa0\xe0-\xff][\x22\x27]/i"; metadata:policy max-detect-ips drop; service:ftp-data, http, imap, pop3; reference:cve,2013-0015; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-009; classtype:attempted-user; sid:25793; rev:3; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"BROWSER-IE Microsoft Internet Explorer invalid Shift_JIS character xss attempt"; flow:to_server,established; file_data; content:"<input value=",fast_pattern,nocase; pcre:"/<input value=[\x22\x27][\x80-\xa0\xe0-\xff][\x22\x27]/i"; metadata:policy max-detect-ips drop; service:smtp; reference:cve,2013-0015; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-009; classtype:attempted-user; sid:25794; rev:3; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"BROWSER-IE Microsoft multiple product toStaticHTML XSS attempt"; flow:to_client,established; file_data; content:"toStaticHTML",fast_pattern,nocase; pcre:"/<\s*style\s*>\s*\w+\s*\{\s*(\w+|\w+-\w+)\s*\:\s*\w+\s*\(.*?(\s*\x27\s*|\s*\&\#39\;\s*|\s*\&\#x27\;\s*|\s*\\u0027\;\s*){1}.*?\)\s*(\s*\x27\s*|\s*\&\#39\;\s*|\s*\&\#x27\;\s*|\s*\\u0027\;\s*){3,}.*?\}|(\s*\x27\s*|\s*\&\#39\;\s*|\s*\&\#x27\;\s*|\s*\\u0027\;\s*){1,}.*?\}\s*(\s*\x27\s*|\s*\&\#39\;\s*|\s*\&\#x27\;\s*|\s*\\u0027\;\s*){3,}/smi"; metadata:policy max-detect-ips drop; service:ftp-data, http, imap, pop3; reference:cve,2012-1858; reference:cve,2012-2520; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-037; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-039; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-050; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-066; classtype:attempted-user; sid:23136; rev:11; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"BROWSER-IE Microsoft multiple product toStaticHTML XSS attempt"; flow:to_server,established; file_data; content:"<style",fast_pattern,nocase; pcre:"/<\s*style\s*>\s*\w+\s*\{\s*(\w+|\w+-\w+)\s*\:\s*\w+\s*\(.*?(\s*\x27\s*|\s*\&\#39\;\s*|\s*\&\#x27\;\s*|\s*\\u0027\;\s*){1}.*?\)\s*(\s*\x27\s*|\s*\&\#39\;\s*|\s*\&\#x27\;\s*|\s*\\u0027\;\s*){3,}.*?\}|(\s*\x27\s*|\s*\&\#39\;\s*|\s*\&\#x27\;\s*|\s*\\u0027\;\s*){1,}.*?\}\s*(\s*\x27\s*|\s*\&\#39\;\s*|\s*\&\#x27\;\s*|\s*\\u0027\;\s*){3,}/smi"; metadata:policy max-detect-ips drop; service:smtp; reference:cve,2012-1858; reference:cve,2012-2520; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-037; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-039; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-050; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-066; classtype:attempted-user; sid:23137; rev:11; )
alert tcp $HOME_NET any -> any $HTTP_PORTS ( msg:"BROWSER-IE Microsoft Internet Explorer XSS filter bypass attempt"; flow:to_server,established; content:"%253C",fast_pattern,nocase; http_raw_uri; content:"%253C",nocase; content:"%253E",distance 4,nocase; metadata:policy max-detect-ips drop; service:http; reference:cve,2014-6365; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-080; classtype:web-application-attack; sid:32710; rev:3; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"BROWSER-IE Microsoft Internet Explorer 9 error handler XSS exploit attempt"; flow:to_server,established; http_uri; content:"onerror=eval"; content:"throw",distance 1; metadata:policy max-detect-ips drop; service:http; reference:cve,2015-0070; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-009; classtype:attempted-user; sid:33352; rev:3; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"BROWSER-IE Microsoft Internet Explorer htmlFile ActiveX control universal XSS attempt"; flow:to_client,established; file_data; content:"<iframe"; content:".ActiveXObject",distance 0; content:"new ",within 500; content:"htmlFile",within 100; content:".setTimeout(",within 100; content:"document.open()",distance 0; content:"new ",within 500; content:"htmlFile",within 100; content:"parentWindow.setTimeout(",within 500,fast_pattern; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:ftp-data, http, imap, pop3; reference:cve,2017-0210; classtype:attempted-user; sid:42204; rev:2; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"BROWSER-IE Microsoft Internet Explorer htmlFile ActiveX control universal XSS attempt"; flow:to_server,established; file_data; content:"<iframe"; content:".ActiveXObject",distance 0; content:"new ",within 500; content:"htmlFile",within 100; content:".setTimeout(",within 100; content:"document.open()",distance 0; content:"new ",within 500; content:"htmlFile",within 100; content:"parentWindow.setTimeout(",within 500,fast_pattern; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:smtp; reference:cve,2017-0210; classtype:attempted-user; sid:42205; rev:2; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"BROWSER-IE Microsoft Internet print table of links cross site scripting attempt"; flow:to_client,established; file_data; content:"WScript.Shell"; content:"Run",within 100; content:"window.print",within 100; metadata:policy max-detect-ips drop; service:ftp-data, http, imap, pop3; reference:url,support.ixiacom.com/strikes/exploits/browser/ie_print_table_of_links_xss_local_zone.xml; classtype:attempted-admin; sid:44199; rev:2; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"BROWSER-IE Microsoft Internet print table of links cross site scripting attempt"; flow:to_server,established; file_data; content:"WScript.Shell"; content:"Run",within 100; content:"window.print",within 100; metadata:policy max-detect-ips drop; service:smtp; reference:url,support.ixiacom.com/strikes/exploits/browser/ie_print_table_of_links_xss_local_zone.xml; classtype:attempted-admin; sid:44200; rev:2; )
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:"BROWSER-IE toStaticHTML CSS import XSS exploit attempt"; flow:to_client,established; file_data; content:"body {background: expression|28|",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:http; reference:cve,2010-3324; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-071; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-072; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-050; classtype:attempted-user; sid:45514; rev:1; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 1900 ( msg:"DELETED EXPLOIT CA ARCserve Backup for Laptops rxsSetDefaultConfigName overflow attempt"; flow:to_server,established; content:"rxsSetDefaultConfigName~~"; isdataat:976,relative; reference:bugtraq,24348; reference:cve,2007-3216; classtype:attempted-admin; sid:12788; rev:4; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 1900 ( msg:"DELETED SERVER-OTHER CA ARCserve Backup for Laptops rxsSetDefaultConfigName overflow attempt"; flow:to_server,established; content:"rxsSetDefaultConfigName~~"; isdataat:976,relative; reference:bugtraq,24348; reference:cve,2007-3216; classtype:attempted-admin; sid:12787; rev:4; )
alert udp $HOME_NET any -> any 53 ( msg:"DELETED BLACKLIST DNS request for known malware domain www.xsser.com"; flow:to_server; byte_test:1,!&,0xF8,2; content:"|03|www|05|xsser|03|com|00|",fast_pattern,nocase; reference:url,www.lacoon.com/lacoon-discovers-xsser-mrat-first-advanced-ios-trojan/; classtype:trojan-activity; sid:32051; rev:2; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"FILE-FLASH Adobe Shockwave Flash Flex authoring tool XSS exploit attempt"; flow:to_server,established; http_uri; content:"/EncDecUtils.swf|3F|",fast_pattern; content:"resourceModuleURLs=",nocase; content:"http",within 4,nocase; metadata:policy max-detect-ips drop; service:http; reference:cve,2011-2461; reference:url,www.adobe.com/support/security/bulletins/apsb11-25.html; classtype:attempted-admin; sid:20610; rev:6; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-FLASH Adobe Flash Player marshallException through JavaScript XSS attempt"; flow:to_client,established; file_data; content:".swf",fast_pattern,nocase; content:"throwException",distance 0,nocase; content:"sendDataToJS",within 300,nocase; pcre:"/var\s+?(?P<unesc>\w+?)\s*?=\s*?([^'"]|['"])+?[^>]*?throwException\s*?\(\s*?(?P=unesc)\s*?\)[^\r]*?sendDataToJS\s*?\(\s*?(?P=unesc)\s*?\)/i"; metadata:policy max-detect-ips drop; service:ftp-data, http, imap, pop3; reference:bugtraq,67962; reference:cve,2014-0531; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-16.html; classtype:attempted-user; sid:31749; rev:3; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-FLASH Adobe Flash Player marshallException through JavaScript XSS attempt"; flow:to_server,established; file_data; content:".swf",fast_pattern,nocase; content:"throwException",distance 0,nocase; content:"sendDataToJS",within 300,nocase; pcre:"/var\s+?(?P<unesc>\w+?)\s*?=\s*?([^'"]|['"])+?[^>]*?throwException\s*?\(\s*?(?P=unesc)\s*?\)[^\r]*?sendDataToJS\s*?\(\s*?(?P=unesc)\s*?\)/i"; metadata:policy max-detect-ips drop; service:smtp; reference:bugtraq,67962; reference:cve,2014-0531; reference:url,helpx.adobe.com/security/products/flash-player/apsb14-16.html; classtype:attempted-user; sid:31750; rev:4; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-OTHER Microsoft MHTML XSS attempt"; flow:to_server,established; flowbits:isset,file.mht; file_data; content:"MIME-Version",fast_pattern,nocase; pcre:"/(\x3C\s*script|onload|onclick|onmouseover)/ims"; metadata:policy max-detect-ips drop; service:smtp; reference:cve,2011-0096; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-026; classtype:attempted-user; sid:23562; rev:3; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-OTHER Microsoft Windows MHTML XSS attempt"; flow:to_server,established; file_data; content:"mhtml|3A|"; pcre:"/(location\x2ereplace\x28|window\x2elocation\x2ehref\s*?=|iframe\s*?src\s*?=|a\s*?href\s*?=)\s*?[\x22\x27]mhtml\x3a(http|file)\x3a\x2f\x2f/Rsmi"; metadata:policy max-detect-ips drop; service:smtp; reference:cve,2011-0096; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-026; classtype:attempted-user; sid:23563; rev:4; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-OTHER MHTML XSS attempt"; flow:to_client,established; flowbits:isset,file.mht; file_data; content:"MIME-Version",fast_pattern,nocase; pcre:"/(\x3C\s*script|onload|onclick|onmouseover)/ims"; metadata:policy max-detect-ips drop; service:ftp-data, http, imap, pop3; reference:cve,2011-0096; reference:cve,2014-1747; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-026; classtype:attempted-user; sid:20133; rev:10; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Xsser mRAT GPS data upload"; flow:to_server,established; http_uri; content:"/TargetUploadGps.aspx?&tmac=",fast_pattern,nocase; content:"&JZ"; metadata:impact_flag red,policy balanced-ips drop,policy security-ips drop; service:http; reference:url,www.lacoon.com/lacoon-discovers-xsser-mrat-first-advanced-ios-trojan/; classtype:trojan-activity; sid:32053; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Xsser mRAT file upload"; flow:to_server,established; http_uri; content:"/TargetUploadFile.aspx?tmac=",fast_pattern,nocase; metadata:impact_flag red,policy security-ips drop; service:http; reference:url,www.lacoon.com/lacoon-discovers-xsser-mrat-first-advanced-ios-trojan/; classtype:trojan-activity; sid:32054; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC User-Agent Xsser mRAT user-agent"; flow:to_server,established; http_header; content:"xsser.0day (unknown version)",fast_pattern,nocase; metadata:impact_flag red,policy balanced-ips drop,policy security-ips drop; service:http; reference:url,www.lacoon.com/lacoon-discovers-xsser-mrat-first-advanced-ios-trojan/; classtype:trojan-activity; sid:32052; rev:2; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"OS-WINDOWS Microsoft Windows Forefront UAG URL XSS attempt"; flow:to_server, established; http_uri; content:"|2F|m|2F|default|2E|aspx",fast_pattern,nocase; content:"orig_url=",nocase; pcre:"/orig_url=[^\x26]*[\x22\x27\x28\x29\x3C\x3E]/i"; metadata:policy max-detect-ips drop; service:http; reference:cve,2010-2734; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-089; classtype:attempted-admin; sid:18074; rev:8; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"OS-WINDOWS Microsoft Windows MHTML XSS attempt"; flow:to_client,established; file_data; content:"mhtml|3A|"; pcre:"/(location\x2ereplace\x28|window\x2elocation\x2ehref\s*?=|iframe\s*?src\s*?=|a\s*?href\s*?=)\s*?[\x22\x27]mhtml\x3a(http|file)\x3a\x2f\x2f/smi"; metadata:policy max-detect-ips drop; service:ftp-data, http, imap, pop3; reference:cve,2011-0096; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-026; classtype:attempted-user; sid:18335; rev:21; )
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:"OS-WINDOWS Microsoft Windows Help Centre escape sequence XSS attempt"; flow:to_client,established; file_data; content:"hcp|3A 2F 2F|",nocase; content:"script",distance 0,nocase; pcre:"/hcp\x3a\x2f\x2f[^\n]*script/i"; metadata:policy max-detect-ips drop; service:http; reference:bugtraq,40725; reference:cve,2003-0907; reference:cve,2010-1885; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-042; classtype:attempted-user; sid:16665; rev:13; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"OS-WINDOWS Microsoft SCCM ReportChart xss attempt"; flow:to_server,established; http_uri; content:"/ReportChart.asp?",nocase; content:"ReportID=",nocase; pcre:"/[?&]ReportID=\d+?&[^&]+?([\x22\x27\x3c\x3e\x28\x29]|script|onload|src)/i"; metadata:policy max-detect-ips drop; service:http; reference:cve,2012-2536; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-062; classtype:web-application-attack; sid:24128; rev:9; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"OS-WINDOWS Microsoft ForeFront UAG ExcelTable.asp XSS attempt"; flow:to_server,established; http_uri; content:"ExcelTable.asp",fast_pattern,nocase; http_client_body; content:"tableData=",nocase; pcre:"/^[^\&\r\n]*[<\(][^\&\r\n]+[\)>]/R"; metadata:policy max-detect-ips drop; service:http; reference:cve,2011-1896; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-079; classtype:attempted-user; sid:20257; rev:8; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"OS-WINDOWS Microsoft generic javascript handler in URI XSS attempt"; flow:to_server,established; http_uri; content:"javascript|3A|",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:http; reference:cve,2011-1897; reference:cve,2012-0017; reference:cve,2015-6099; reference:cve,2016-3212; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-079; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-011; reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-118; reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-063; classtype:attempted-user; sid:20258; rev:12; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"OS-WINDOWS Microsoft Forefront UAG URL XSS alternate attempt"; flow:to_server, established; http_uri; content:"signurl|2E|asp",fast_pattern,nocase; content:"SignUrl=",nocase; pcre:"/SignUrl=[^\x26\s]*[\x22\x27\x28\x29\x3C\x3E]/i"; metadata:policy max-detect-ips drop; service:http; reference:cve,2010-3936; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-089; classtype:attempted-admin; sid:18076; rev:11; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"OS-WINDOWS Microsoft Certification service XSS attempt"; flow:to_server,established; http_uri; content:"certfnsh|2E|asp",nocase; http_client_body; content:"TargetStoreFlagsObserve",nocase; pcre:"/TargetStoreFlagsObserve=[^\s\x26]*[\x3C\x3E\x22\x27\x28\x29]/"; metadata:policy max-detect-ips drop; service:http; reference:cve,2011-1264; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-051; classtype:attempted-user; sid:19186; rev:11; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"OS-WINDOWS Microsoft Report Viewer reflect XSS attempt"; flow:to_server,established; http_uri; content:"ReportID|3D|",nocase; content:"ControlID|3D|",nocase; content:"TimerMethod|3D|",nocase; pcre:"/TimerMethod\x3D[^\x26]*[\x3C\x28\x22\x27]/i"; metadata:policy max-detect-ips drop; service:http; reference:cve,2011-1976; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-067; classtype:attempted-user; sid:19681; rev:5; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"OS-WINDOWS Microsoft Lync Server meeting URL XSS attempt"; flow:to_server,established; http_uri; content:"url=",fast_pattern,nocase; pcre:"/[?&]url=[^&]*?javascript\x3a/i"; metadata:policy max-detect-ips drop; service:http; reference:cve,2014-1823; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-032; classtype:web-application-attack; sid:31217; rev:4; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"OS-WINDOWS Microsoft Windows MHTML XSS attempt"; flow:to_client,established; file_data; content:"CjxiPlRoZXNlIGFyZSBub3QgdGhlIGRyb2lkcyB5b3UgYXJlIGxvb2tpbmcgZm9yPC9iPg",fast_pattern,nocase; content:"o8c2NyaXB0PmFsZXJ0KCdCcmVha2luZ1BvaW50Jyk7PC9zY3JpcHQ"; metadata:policy max-detect-ips drop; service:ftp-data, http, imap, pop3; reference:cve,2011-0096; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-026; classtype:attempted-user; sid:52335; rev:1; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 23 ( msg:"PROTOCOL-TELNET TippingPoint IPS telnet login failure xss attempt"; flow:to_server,established; content:"<script>alert(123)</script>",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:telnet; classtype:misc-attack; sid:45191; rev:1; )
alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS ( msg:"PROTOCOL-VOIP Contact header XSS injection attempt"; flow:to_server,established; content:"<script",fast_pattern,nocase; http_header; pcre:"/^Contact\x3A\s+(\x22)?\x3Cscript/smi"; metadata:policy max-detect-ips drop; service:sip; classtype:misc-attack; sid:20367; rev:6; )
alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS ( msg:"PROTOCOL-VOIP Contact header XSS injection attempt"; flow:to_server; content:"<script",fast_pattern,nocase; http_header; pcre:"/^Contact\x3A\s+(\x22)?\x3Cscript/smi"; metadata:policy max-detect-ips drop; service:sip; classtype:misc-attack; sid:20366; rev:6; )
alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS ( msg:"PROTOCOL-VOIP Call-ID header XSS injection attempt"; flow:to_server,established; content:"<script",fast_pattern,nocase; http_header; pcre:"/^Call-ID\x3A\s+(\x22)?\x3Cscript/smi"; metadata:policy max-detect-ips drop; service:sip; classtype:misc-attack; sid:20357; rev:6; )
alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS ( msg:"PROTOCOL-VOIP Call-ID header XSS injection attempt"; flow:to_server; content:"<script",fast_pattern,nocase; http_header; pcre:"/^Call-ID\x3A\s+(\x22)?\x3Cscript/smi"; metadata:policy max-detect-ips drop; service:sip; classtype:misc-attack; sid:20356; rev:6; )
alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS ( msg:"PROTOCOL-VOIP Subject header XSS injection attempt"; flow:to_server,established; content:"<script",fast_pattern,nocase; http_header; pcre:"/^Subject\x3A\s+(\x22)?\x3Cscript/smi"; metadata:policy max-detect-ips drop; service:sip; classtype:misc-attack; sid:20349; rev:6; )
alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS ( msg:"PROTOCOL-VOIP Subject header XSS injection attempt"; flow:to_server; content:"<script",fast_pattern,nocase; http_header; pcre:"/^Subject\x3A\s+(\x22)?\x3Cscript/smi"; metadata:policy max-detect-ips drop; service:sip; classtype:misc-attack; sid:20348; rev:6; )
alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS ( msg:"PROTOCOL-VOIP To header XSS injection attempt"; flow:to_server,established; content:"<script",fast_pattern,nocase; http_header; pcre:"/^To\x3A\s+(\x22)?\x3Cscript/smi"; metadata:policy max-detect-ips drop; service:sip; classtype:misc-attack; sid:20335; rev:6; )
alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS ( msg:"PROTOCOL-VOIP To header XSS injection attempt"; flow:to_server; content:"<script",fast_pattern,nocase; http_header; pcre:"/^To\x3A\s+(\x22)?\x3Cscript/smi"; metadata:policy max-detect-ips drop; service:sip; classtype:misc-attack; sid:20334; rev:6; )
alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS ( msg:"PROTOCOL-VOIP From header XSS injection attempt"; flow:to_server,established; content:"<script",fast_pattern,nocase; http_header; pcre:"/^From\x3A\s+(\x22)?\x3Cscript/smi"; metadata:policy max-detect-ips drop; service:sip; classtype:misc-attack; sid:20321; rev:6; )
alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS ( msg:"PROTOCOL-VOIP From header XSS injection attempt"; flow:to_server; content:"<script",fast_pattern,nocase; http_header; pcre:"/^From\x3A\s+(\x22)?\x3Cscript/smi"; metadata:policy max-detect-ips drop; service:sip; classtype:misc-attack; sid:20320; rev:6; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"SERVER-APACHE Apache Jetspeed PageManagementService persistent XSS attempt"; flow:to_client,established; file_data; content:"/jetspeed/services/pagemanagement/info/.psml/_user/",fast_pattern,nocase; content:"title",within 200; content:"value",within 50; pcre:"/value(=|%3d)[\x22\x27][^\x22\x27]*?([\x3c\x3e\x28\x29]|script|onload|src|%3c|%3e|%28|%29)/i"; metadata:policy max-detect-ips drop; service:ftp-data, http, imap, pop3; reference:cve,2016-0711; classtype:attempted-user; sid:46326; rev:2; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"SERVER-APACHE Apache Jetspeed PageManagementService persistent XSS attempt"; flow:to_server,established; http_uri; content:"/jetspeed/services/pagemanagement/info/.psml/_user/",fast_pattern,nocase; http_client_body; content:"title",nocase; pcre:"/title(=|%3d)[^\x0d]*?([\x3c\x3e\x28\x29]|script|onload|src|%3c|%3e|%28|%29)/i"; metadata:policy max-detect-ips drop; service:http; reference:cve,2016-0711; classtype:attempted-user; sid:46327; rev:2; )
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:"SERVER-MAIL Microsoft Windows Exchange OWA XSS and spoofing attempt"; flow:to_client,established; file_data; content:"exchange/calendar/pick.asp?view=ppp%22></applet><script>alert|28|%22hi,%20this%20is%20javascript%20here%22|29|</script>|22|>click this</a>"; metadata:policy max-detect-ips drop; service:http; reference:bugtraq,10902; reference:cve,2004-0203; classtype:misc-attack; sid:15964; rev:10; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"SERVER-MAIL Microsoft Exchange OWA meeting invite XSS attempt"; flow:to_server,established; file_data; content:"BEGIN:VCALENDAR",depth 15; content:"|0D 0A|DESCRIPTION:",distance 0; content:"onerror=",within 300,nocase; metadata:policy max-detect-ips drop; service:smtp; reference:cve,2014-6326; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-075; classtype:misc-attack; sid:32705; rev:2; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"SERVER-MAIL Microsoft Exchange UM Management user stored XSS attempt"; flow:to_server,established; http_client_body; content:"UM Management"; content:"Members",within 300; content:"Identity:ECP|22|,|22|DisplayName|22|:|22|",fast_pattern,nocase; pcre:"/Identity:ECP\x22\x2C\x22DisplayName\x22:\x22[^\x22]*\x22(?!\s*,\s*\x22RawIdentity)/si"; metadata:policy max-detect-ips drop; service:http; reference:cve,2015-1630; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-026; classtype:web-application-attack; sid:33811; rev:3; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-ORACLE BPEL process manager XSS injection attempt"; flow:to_server,established; http_uri; content:"/BPELConsole/default/activities.jsp?",nocase; content:"'",distance 0; metadata:policy max-detect-ips drop; service:http; reference:cve,2008-4014; reference:url,www.securityfocus.com/archive/1/500060; classtype:web-application-attack; sid:15256; rev:7; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"SERVER-OTHER Palo Alto Networks Firewall editUser.esp XSS attempt"; flow:to_server,established; http_uri; content:"/esp/editUser.esp",fast_pattern,nocase; content:"role=",nocase; pcre:"/[\x3f\x26]role=[^\x26]*?[^\x26a-z0-9\x5b\x5d\x2d]/smi"; metadata:policy max-detect-ips drop; service:http; reference:cve,2010-0475; classtype:web-application-attack; sid:16689; rev:9; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 52312 ( msg:"SERVER-OTHER IBM Tivoli Endpoint Manager Web Reports xss attempt"; flow:to_server,established; content:"ScheduleParam",nocase; pcre:"/^\x3d[^\s\x26\x0d\x0a]*?\x2527/iR"; metadata:policy max-detect-ips drop; service:http; reference:cve,2012-0719; reference:url,www.ibm.com/support/docview.wss?uid=swg21587743; classtype:attempted-user; sid:21944; rev:7; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"SERVER-OTHER Microsoft SharePoint XSS attempt"; flow:to_server,established; http_uri; content:"/Lists/Links/AllItems.aspx",nocase; http_client_body; content:"UrlFieldUrl=",nocase; pkt_data; content:"javascript|3B|",within 50,nocase; metadata:policy max-detect-ips drop; service:ftp-data, http, imap, pop3; reference:cve,2013-3895; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-084; classtype:attempted-admin; sid:28201; rev:3; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS [$HTTP_PORTS,443,8443] ( msg:"SERVER-OTHER McAfee ePolicy Orchestrator XSS attempt"; flow:to_server,established; http_uri; content:"/core/loadDisplayType.do",fast_pattern,nocase; pkt_data; pcre:"/[?&]instanceId=[^&]+?([\x22\x27\x3c\x3e\x28\x29]|script|onload|src)/i"; metadata:policy max-detect-ips drop; service:http, ssl; reference:bugtraq,59505; reference:cve,2013-0141; reference:url,funoverip.net/2013/06/mcafee-epolicy-0wner-preview/; classtype:attempted-admin; sid:28821; rev:3; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS [$HTTP_PORTS,443,8443] ( msg:"SERVER-OTHER McAfee ePolicy Orchestrator XSS attempt"; flow:to_server,established; http_uri; content:"/console/createDashboardContainer.do?monitorUrl=",fast_pattern,nocase; pcre:"/[?&]monitorUrl=[^&]+?([\x22\x27\x3c\x3e\x28\x29]|script|onload|src)/i"; metadata:policy max-detect-ips drop; service:http, ssl; reference:bugtraq,59505; reference:cve,2013-0141; reference:url,funoverip.net/2013/06/mcafee-epolicy-0wner-preview/; classtype:attempted-admin; sid:28822; rev:2; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS [$HTTP_PORTS,443,8443] ( msg:"SERVER-OTHER McAfee ePolicy Orchestrator XSS attempt"; flow:to_server,established; http_uri; content:"/ComputerMgmt/sysDetPanelBoolPie.do?uid=",fast_pattern,nocase; pcre:"/uid=\s?\D{1,3}/i"; metadata:policy max-detect-ips drop; service:http, ssl; reference:bugtraq,59505; reference:cve,2013-0141; reference:url,funoverip.net/2013/06/mcafee-epolicy-0wner-preview/; classtype:attempted-admin; sid:28823; rev:2; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS [$HTTP_PORTS,443,8443] ( msg:"SERVER-OTHER McAfee ePolicy Orchestrator XSS attempt"; flow:to_server,established; http_uri; content:"/ComputerMgmt/sysDetPanelQry.do",fast_pattern,nocase; pkt_data; pcre:"/uid=\s?\D{1,3}/i"; metadata:policy max-detect-ips drop; service:http, ssl; reference:bugtraq,59505; reference:cve,2013-0141; reference:url,funoverip.net/2013/06/mcafee-epolicy-0wner-preview/; classtype:attempted-admin; sid:28824; rev:3; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS [$HTTP_PORTS,443,8443] ( msg:"SERVER-OTHER McAfee ePolicy Orchestrator XSS attempt"; flow:to_server,established; http_uri; content:"/ComputerMgmt/sysDetPanelQry.do?sysDetPanelQry=",fast_pattern,nocase; pcre:"/[?&]sysDetPanelQry=[^&]+?([\x22\x27\x3c\x3e\x28\x29]|script|onload|src)/i"; metadata:policy max-detect-ips drop; service:http, ssl; reference:bugtraq,59505; reference:cve,2013-0141; reference:url,funoverip.net/2013/06/mcafee-epolicy-0wner-preview/; classtype:attempted-admin; sid:28825; rev:2; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS [$HTTP_PORTS,443,8443] ( msg:"SERVER-OTHER McAfee ePolicy Orchestrator XSS attempt"; flow:to_server,established; http_uri; content:"/ComputerMgmt/sysDetPanelSummary.do?sysDetPanelSummary=",fast_pattern,nocase; pcre:"/[?&]sysDetPanelSummary=[^&]+?([\x22\x27\x3c\x3e\x28\x29]|script|onload|src)/i"; metadata:policy max-detect-ips drop; service:http, ssl; reference:bugtraq,59505; reference:cve,2013-0141; reference:url,funoverip.net/2013/06/mcafee-epolicy-0wner-preview/; classtype:attempted-admin; sid:28826; rev:2; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS [$HTTP_PORTS,443,8443] ( msg:"SERVER-OTHER McAfee ePolicy Orchestrator XSS attempt"; flow:to_server,established; http_uri; content:"/ComputerMgmt/sysDetPanelSummary.do",fast_pattern,nocase; pkt_data; pcre:"/uid=\s?\D{1,3}/i"; metadata:policy max-detect-ips drop; service:http, ssl; reference:bugtraq,59505; reference:cve,2013-0141; reference:url,funoverip.net/2013/06/mcafee-epolicy-0wner-preview/; classtype:attempted-admin; sid:28827; rev:3; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"SERVER-OTHER Cougar-LG addr parameter XSS attempt"; flow:to_server, established; http_uri; content:"lg.cgi",fast_pattern,nocase; http_client_body; content:"router=",depth 250; content:"query=",depth 250; content:"addr=",depth 250; pcre:"/addr\s*?\x3d\s*?[a-z\d\.]*?[^a-z\d\.&]/smi"; metadata:policy max-detect-ips drop; service:http; reference:cve,2014-3926; reference:url,www.s3.eurecom.fr/cve/CVE-2014-3926.txt; classtype:misc-attack; sid:31766; rev:2; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"SERVER-OTHER Microsoft Sharepoint Server Newsfeed XSS attempt"; flow:established,to_server; http_header; content:"/my/_layouts/",fast_pattern,nocase; http_uri; content:"|22|"; content:"(",within 30; metadata:policy max-detect-ips drop; service:http; reference:cve,2015-1636; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-022; classtype:web-application-attack; sid:33808; rev:3; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"SERVER-OTHER Microsoft Sharepoint user display name XSS attempt"; flow:to_server,established; http_uri; content:"useredit.aspx?",fast_pattern,nocase; content:"ID=",nocase; http_client_body; content:"TextField="; pcre:"/TextField=[^&]*([\x22\x27\x28\x29\x3c\x3e]|script|onload|src)/i"; metadata:policy max-detect-ips drop; service:ftp-data, http, imap, pop3; reference:cve,2015-1633; reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-022; classtype:attempted-user; sid:33809; rev:3; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"SERVER-OTHER Microsoft SharePoint projectdetails.aspx ret parameter XSS attempt"; flow:to_server,established; http_uri; content:"/projectdetails.aspx?",fast_pattern,nocase; content:"ret=",nocase; pcre:"/ret=[^&]*([\x22\x27\x28\x29\x3c\x3e]|script|onload|src)/i"; metadata:policy max-detect-ips drop; service:ftp-data, http, imap, pop3; reference:cve,2015-1640; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-036; classtype:attempted-user; sid:34099; rev:3; )
alert tcp $EXTERNAL_NET 443 -> $HOME_NET any ( msg:"SERVER-OTHER InsideSecure MatrixSSL x509 IssuerDomainPolicy remote code execution attempt"; flow:to_client,established; content:"|30 82|",depth 2; content:"|06 03 55 1D 21 04 81 85 30 81 82 30 18 06 0A 60 76 48 01 65 03 02 01 03 01|",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:ssl; reference:cve,2017-2780; reference:cve,2017-2781; reference:url,www.talosintelligence.com/reports/TALOS-2017-0276/; reference:url,www.talosintelligence.com/reports/TALOS-2017-0277/; classtype:attempted-user; sid:41467; rev:7; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"SERVER-WEBAPP HP Insight Diagnostics XSS attempt"; flow:to_server,established; content:"/hpdiags/",fast_pattern,nocase; pcre:"/\x2fhpdiags\x2f(parameters|idstatusframe|survey|globals|custom)\.php\x3f.*?(device|pid|cfg|category|tabpage|testmode)=[^\x26]*?(script|onclick|onload|onmouseover|[\x22\x27\x3c\x3e\x28\x29])/i"; metadata:policy max-detect-ips drop; service:http; reference:cve,2010-3003; classtype:web-application-attack; sid:21314; rev:4; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-WEBAPP LongTail Video JW Player XSS attempt link param"; flow:to_server,established; http_uri; content:"/player.swf?",fast_pattern; content:"link=",distance 0; content:"javascript:",distance 0; metadata:policy max-detect-ips drop; service:http; reference:bugtraq,54101; reference:cve,2012-3351; classtype:web-application-attack; sid:23984; rev:4; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"SERVER-WEBAPP IBM System Storage DS storage manager profiler XSS attempt"; flow:to_server,established; http_uri; content:"/SoftwareRegistration.do",fast_pattern,nocase; pcre:"/SoftwareRegistration\.do.*?updateRegn=[^\x26\r\n]+(script|onclick|onload|onmouseover|html|[\x22\x27\x3c\x3e\x28\x29])/i"; metadata:policy max-detect-ips drop; service:http; reference:bugtraq,54112; reference:cve,2012-2172; reference:url,www.exploit-db.com/exploits/19321/; classtype:web-application-attack; sid:23466; rev:6; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"SERVER-WEBAPP Cisco Common Services Device Center XSS attempt"; flow:to_server,established; http_uri; content:"/cwhp/device.center.do",fast_pattern,nocase; pcre:"/device\.center\.do\?[^$\n]*(DeviceID|objectID|dsOsName|device)=[^$\n]*([\x3C\x3E\x22\x27]|script|src|location|document)/i"; metadata:policy max-detect-ips drop; service:http; reference:cve,2011-0962; classtype:web-application-attack; sid:21389; rev:5; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"SERVER-WEBAPP Cisco Common Services Help servlet XSS attempt"; flow:to_server,established; http_uri; content:"com.cisco.nm.help.ServerHelpEngine",fast_pattern,nocase; pcre:"/com\.cisco\.nm\.help\.ServerHelpEngine\?[^$\n]*tag=[^$\n]*([\x3C\x3E\x22\x27]|script|src|location|document)/Oi"; metadata:policy max-detect-ips drop; service:http; reference:cve,2011-0961; classtype:web-application-attack; sid:21385; rev:5; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"SERVER-WEBAPP Devellion CubeCart searchStr parameter SQL injection"; flow:to_server,established; http_uri; content:"searchStr='",fast_pattern; content:"/index.php?",nocase; metadata:policy max-detect-ips drop; service:http; reference:url,www.acunetix.com/blog/web-security-zone/articles/sql-injection-xss-cubecart-4-3-3/; classtype:web-application-attack; sid:21271; rev:4; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"SERVER-WEBAPP Devellion CubeCart multiple parameter XSS vulnerability"; flow:to_server,established; http_uri; content:"gateway/WorldPay/return.php?"; pcre:"/(amount|cartId|email|transId|transStatus)=[^&]*[\x22\x27\x3c\x3e]/R"; metadata:policy max-detect-ips drop; service:http; reference:url,www.acunetix.com/blog/web-security-zone/articles/sql-injection-xss-cubecart-4-3-3/; classtype:web-application-attack; sid:21270; rev:6; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 9090 ( msg:"SERVER-WEBAPP Jive Software Openfire muc-room-edit-form.jsp XSS attempt"; flow:to_server,established; http_uri; content:"/muc-room-edit-form.jsp",fast_pattern,nocase; pcre:"/muc-room-edit-form\.jsp\?.*?=([^\x26]*[\x22\x27\x3C\x3E\x28\x29\x3B]|script|src|location|document)/"; metadata:policy max-detect-ips drop; service:http; reference:bugtraq,32935; reference:cve,2009-0496; classtype:web-application-attack; sid:20868; rev:8; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 9090 ( msg:"SERVER-WEBAPP Jive Software Openfire server-properties.jsp XSS attempt"; flow:to_server,established; http_uri; content:"/server-properties.jsp",fast_pattern,nocase; pcre:"/server-properties\.jsp\?.*?=([^\x26]*[\x22\x27\x3C\x3E\x28\x29\x3B]|script|src|location|document)/"; metadata:policy max-detect-ips drop; service:http; reference:bugtraq,32935; reference:cve,2009-0496; classtype:web-application-attack; sid:20867; rev:8; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 9090 ( msg:"SERVER-WEBAPP Jive Software Openfire audit-policy.jsp XSS attempt"; flow:to_server,established; http_uri; content:"/audit-policy.jsp",fast_pattern,nocase; pcre:"/audit-policy\.jsp\?.*?=([^\x26]*[\x22\x27\x3C\x3E\x28\x29\x3B]|script|src|location|document)/"; metadata:policy max-detect-ips drop; service:http; reference:bugtraq,32935; reference:cve,2009-0496; classtype:web-application-attack; sid:20866; rev:8; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 9090 ( msg:"SERVER-WEBAPP Jive Software Openfire user-properties.jsp XSS attempt"; flow:to_server,established; http_uri; content:"/user-properties.jsp",fast_pattern,nocase; pcre:"/user-properties\.jsp\?.*?=([^\x26]*[\x22\x27\x3C\x3E\x28\x29\x3B]|script|src|location|document)/"; metadata:policy max-detect-ips drop; service:http; reference:bugtraq,32935; reference:cve,2009-0496; classtype:web-application-attack; sid:20865; rev:8; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 9090 ( msg:"SERVER-WEBAPP Jive Software Openfire group-summary.jsp XSS attempt"; flow:to_server,established; http_uri; content:"/group-summary.jsp",fast_pattern,nocase; pcre:"/group-summary\.jsp\?.*?=([^\x26]*[\x22\x27\x3C\x3E\x28\x29\x3B]|script|src|location|document)/"; metadata:policy max-detect-ips drop; service:http; reference:bugtraq,32935; reference:cve,2009-0496; classtype:web-application-attack; sid:20864; rev:8; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 9090 ( msg:"SERVER-WEBAPP Jive Software Openfire log.jsp XSS attempt"; flow:to_server,established; http_uri; content:"/log.jsp",fast_pattern,nocase; pcre:"/log\.jsp\?.*?=([^\x26]*[\x22\x27\x3C\x3E\x28\x29\x3B]|script|src|location|document)/"; metadata:policy max-detect-ips drop; service:http; reference:bugtraq,32935; reference:cve,2009-0496; classtype:web-application-attack; sid:20863; rev:8; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 9090 ( msg:"SERVER-WEBAPP Jive Software Openfire logviewer.jsp XSS attempt"; flow:to_server,established; http_uri; content:"/logviewer.jsp",fast_pattern,nocase; pcre:"/logviewer\.jsp\?.*?=([^\x26]*[\x22\x27\x3C\x3E\x28\x29\x3B]|script|src|location|document)/"; metadata:policy max-detect-ips drop; service:http; reference:bugtraq,32935; reference:cve,2009-0496; classtype:web-application-attack; sid:20862; rev:8; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"SERVER-WEBAPP raSMP User-Agent XSS injection attempt"; flow:established, to_server; http_header; content:"onload",fast_pattern,nocase; http_uri; content:"index.php",nocase; http_header; content:"User-Agent|3A|",nocase; pcre:"/^User-Agent\x3A[^\r\n]*?onload=/im"; metadata:policy max-detect-ips drop; service:http; reference:bugtraq,16138; reference:cve,2006-0084; classtype:attempted-admin; sid:18467; rev:5; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"SERVER-WEBAPP raSMP User-Agent XSS injection attempt"; flow:established, to_server; http_header; content:"<script",fast_pattern,nocase; http_uri; content:"index.php",nocase; http_header; content:"User-Agent|3A|",nocase; pcre:"/^User-Agent\x3A[^\r\n]*?<script/im"; metadata:policy max-detect-ips drop; service:http; reference:bugtraq,16138; reference:cve,2006-0084; classtype:attempted-admin; sid:18466; rev:5; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"SERVER-WEBAPP WordPress XSS fs-admin.php injection attempt"; flow:to_server,established; http_uri; content:"page=forum-server/fs-admin/fs-admin.php",fast_pattern,nocase; pcre:"/[?&](groupid|usergroup_id)=[^&]+?([\x22\x27\x3c\x3e\x28\x29]|script|onload|src)/i"; metadata:policy max-detect-ips drop; service:http; classtype:web-application-attack; sid:24561; rev:4; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"SERVER-WEBAPP Microsoft ASP.NET improper comment handling XSS attempt"; flow:to_server,established; http_uri; content:".aspx|3F|",nocase; content:"/*-*/",distance 0; content:"/**/",distance 0; metadata:policy max-detect-ips drop; service:http; reference:bugtraq,20753; reference:cve,2006-7192; reference:cve,2008-3842; reference:cve,2008-3843; classtype:web-application-attack; sid:23172; rev:7; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-WEBAPP Microsoft Office SharePoint query.iqy XSS attempt"; flow:to_server,established; http_uri; content:"/owssvr.dll?",nocase; content:"query.iqy",distance 0,fast_pattern,nocase; pcre:"/[?&]Using=_layouts\/query.iqy.*?&List=[^&]+(script|src|location|document|onlick|onload)/i"; metadata:policy max-detect-ips drop; service:http; reference:cve,2012-1863; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-050; classtype:attempted-user; sid:23282; rev:7; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"SERVER-WEBAPP Microsoft Office SharePoint scriptresx.ashx XSS attempt"; flow:to_server,established; http_uri; content:"_layouts/scriptresx.ashx",fast_pattern,nocase; pcre:"/sections=[^\r\n\x26]+(script|onclick|onload|onmouseover|html|[\x22\x27\x3c\x3e\x28\x29])/i"; metadata:policy max-detect-ips drop; service:http; reference:cve,2012-1859; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-050; classtype:web-application-attack; sid:23281; rev:6; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"SERVER-WEBAPP Microsoft SharePoint chart webpart XSS attempt"; flow:to_server,established; http_uri; content:"_layouts/Chart/WebUI/WizardList.aspx",fast_pattern,nocase; pcre:"/([sp]key|csk)=[^\r\n\x26]+(script|onclick|onload|onmouseover|html|[\x22\x27\x3c\x3e\x28\x29])/i"; metadata:policy max-detect-ips drop; service:http; reference:cve,2012-0145; reference:url,technet.microsoft.com/en-us/security/bulletin/ms12-011; classtype:web-application-attack; sid:21298; rev:5; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"SERVER-WEBAPP Microsoft Office SharePoint themeweb.aspx XSS attempt"; flow:to_server,established; http_uri; content:"/_layouts/themeweb.aspx",fast_pattern,nocase; pkt_data; pcre:"/ctl\d+\x24PlaceHolderMain\x24ctl\d+\x24customizeThemeSection\x24(accent1|accent2|accent3|accent4|accent5|accent6|dark1|dark2|light1|light2)=[^\r\n\x26]+(script|onclick|onload|onmouseover|[\x22\x27\x3c\x3e\x28\x29])/i"; metadata:policy max-detect-ips drop; service:http; reference:cve,2012-0144; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-011; classtype:web-application-attack; sid:21297; rev:6; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"SERVER-WEBAPP Microsoft Office SharePoint XSS attempt"; flow:to_server,established; http_uri; content:"_layouts/help.aspx?",nocase; content:"cid0=",distance 0,nocase; pcre:"/\x5flayouts\x2fhelp\x2easpx\x3f.*?cid0\x3d[A-Za-z\x5c\x2e0-9]*[^A-Za-z\x5c\x2f\x2e\x26\x3d0-9\s]/si"; metadata:policy max-detect-ips drop; service:http; reference:cve,2010-0817; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-039; classtype:attempted-user; sid:16560; rev:17; )
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:"SERVER-WEBAPP Microsoft SharePoint XSS"; flow:to_client,established; file_data; content:"|26|amp|3B|",nocase; content:"expression|28|",distance 0,nocase; pcre:"/\x26amp\x3B[^\r\n]+expression\x28/"; metadata:policy max-detect-ips drop; service:http; reference:cve,2011-1252; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-074; classtype:web-application-attack; sid:20117; rev:8; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"SERVER-WEBAPP Microsoft Office SharePoint Javascript XSS attempt"; flow:to_server,established; http_uri; content:"Using=_layouts/query",fast_pattern,nocase; pcre:"/Using=_layouts\/query(\.iqy|\.bqy).*(View|RowFolder)=[^&\x3b]*<\s*script/i"; metadata:policy max-detect-ips drop; service:http; reference:cve,2011-1893; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-074; classtype:web-application-attack; sid:20116; rev:14; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"SERVER-WEBAPP Microsoft Office SharePoint XSS vulnerability attempt"; flow:to_server,established; http_method; content:"POST",nocase; http_uri; content:"/Home.aspx",nocase; http_client_body; content:"RichHtmlField$hiddenDisplay",nocase; content:"%3Cscript",distance 0,nocase; metadata:policy max-detect-ips drop; service:http; reference:cve,2011-1890; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-074; classtype:attempted-user; sid:20113; rev:10; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"SERVER-WEBAPP Microsoft Office SharePoint XSS vulnerability attempt"; flow:to_server,established; http_method; content:"POST",nocase; http_uri; content:"/NewForm.aspx",nocase; http_client_body; content:"TextField_spSave",nocase; content:"%3Cscript",distance 0,nocase; metadata:policy max-detect-ips drop; service:http; reference:cve,2011-1890; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-074; classtype:attempted-user; sid:20112; rev:9; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"SERVER-WEBAPP Microsoft Office SharePoint XSS vulnerability attempt"; flow:to_server,established; http_uri; content:"/calendar.aspx",nocase; content:"Calendardate=",distance 0,nocase; pcre:"/[?&]CalendarDate=[^&]+?([\x22\x27\x3c\x3e\x28\x29]|script|onload|src)/i"; metadata:policy max-detect-ips drop; service:http; reference:cve,2011-0653; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-074; classtype:attempted-user; sid:20111; rev:9; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"SERVER-WEBAPP JavaScript tag in User-Agent field possible XSS attempt"; flow:to_server,established; http_header; content:"User-Agent|3A| <SCRIPT>",fast_pattern,nocase; metadata:policy max-detect-ips drop,ruleset community; service:http; reference:url,blog.spiderlabs.com/2012/11/honeypot-alert-referer-field-xss-attacks.html; classtype:web-application-attack; sid:26483; rev:3; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"SERVER-WEBAPP Drupal VideoWhisper Webcam plugin XSS attempt"; flow:to_server,established; http_uri; content:"/index.php?q=vwrooms/logout",fast_pattern,nocase; pcre:"/^\x2Findex\x2Ephp\x3Fq=vwrooms\x2Flogout[^\x3E]*?\x26message=[^\x26]+(script|onload|onmouseover|\x27|\x22|\x3c|\x3e|src)/smi"; metadata:policy max-detect-ips drop; service:http; reference:cve,2014-2715; reference:url,securityfocus.com/archive/1/531935; classtype:web-application-attack; sid:30910; rev:2; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"SERVER-WEBAPP Drupal VideoWhisper Webcam plugin XSS attempt"; flow:to_server,established; http_uri; content:"/index.php?q=vwrooms/logout",fast_pattern,nocase; pcre:"/^\x2Findex\x2Ephp\x3Fq=vwrooms\x2Flogout[^\x3E]*?\x26module=[^\x26]+(script|onload|onmouseover|\x27|\x22|\x3c|\x3e|src)/smi"; metadata:policy max-detect-ips drop; service:http; reference:cve,2014-2715; reference:url,securityfocus.com/archive/1/531935; classtype:web-application-attack; sid:30911; rev:2; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"SERVER-WEBAPP Microsoft Sharepoint ThemeOverride XSS Attempt"; flow:to_server,established; http_uri; content:"ThemeOverride|3D|",fast_pattern,nocase; pcre:"/ThemeOverride\x3D[^&]*(\x2F\x3E|\x7D\x3B)/"; metadata:policy max-detect-ips drop; service:http; reference:cve,2014-1754; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-022; classtype:attempted-user; sid:30951; rev:3; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"SERVER-WEBAPP Wordpress XSS Clean and Simple Contact Form plugin cross-site scripting attempt"; flow:to_server,established; http_uri; content:"/wp-admin/admin-ajax.php",fast_pattern,nocase; http_client_body; content:"cscf"; content:"name",within 7; pcre:"/(^|&)cscf(\x5B|%5B)name(\x5D|%5D)=[A-Z0-9+]*[^A-Z0-9+&]/i"; metadata:policy max-detect-ips drop; service:http; reference:cve,2014-8955; classtype:attempted-user; sid:32939; rev:2; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"SERVER-WEBAPP vBulletin XSS redirect attempt"; flow:to_server,established; http_uri; content:"/misc.php?v="; content:"&js=js",within 12; metadata:policy max-detect-ips drop,ruleset community; service:http; reference:url,www.virustotal.com/en/url/6a7664105f1f144930f51e71dd0fec728607b4c9e33037d376cd7bf8351273a9/analysis/1430224991/; classtype:web-application-attack; sid:34287; rev:3; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"SERVER-WEBAPP Wordpress comment field stored XSS attempt"; flow:to_server,established; content:"/wp-comments-post.php",fast_pattern,nocase; content:"comment="; isdataat:2000; content:!"&submit=",within 2000; metadata:policy max-detect-ips drop; service:http; reference:cve,2015-3440; reference:url,klikki.fi/adv/wordpress2.html; classtype:attempted-user; sid:34328; rev:3; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"SERVER-WEBAPP Ignite Realtime Openfire server-session-details cross site scripting attempt"; flow:to_server,established; http_uri; content:"/server-session-details.jsp",fast_pattern,nocase; content:"hostname=",nocase; pcre:"/[?&]hostname=[^&]*?([\x22\x27\x3c\x3e\x28\x29]|script|onload|src)/i"; metadata:policy max-detect-ips drop; service:http; reference:url,hyp3rlinx.altervista.org/advisories/AS-OPENFIRE-XSS.txt; classtype:attempted-user; sid:36182; rev:2; )
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:"SERVER-WEBAPP InterWoven WorkDocs XSS attempt"; flow:to_client,established; file_data; content:"UserOptions.asp",nocase; content:"compnrtid",within 12,fast_pattern,nocase; content:"script",within 72,nocase; metadata:policy max-detect-ips drop; service:http; classtype:web-application-attack; sid:37468; rev:2; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"SERVER-WEBAPP raSMP User-Agent XSS injection attempt"; flow:established, to_server; http_uri; content:"/index.php",fast_pattern,nocase; http_header; content:"User-Agent|3A|",nocase; pcre:"/User-Agent:[^\x0d]*?([\x22\x27\x3c\x3e]|script|onload|src)/i"; metadata:policy max-detect-ips drop; service:http; reference:bugtraq,16138; reference:cve,2006-0084; classtype:web-application-attack; sid:45330; rev:1; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"SERVER-WEBAPP Apache Jetspeed PageManagementService persistent XSS attempt"; flow:to_server,established; http_uri; content:"/jetspeed/services/pagemanagement/info/.psml/_user/",fast_pattern,nocase; content:"title=",nocase; pcre:"/[?&]title=[^&]*?([\x22\x27\x3c\x3e\x28\x29]|script|onload|src)/i"; metadata:policy max-detect-ips drop; service:http; reference:cve,2016-0711; classtype:attempted-user; sid:46328; rev:2; )
alert tcp $HOME_NET 9999 -> $EXTERNAL_NET any ( msg:"SERVER-WEBAPP SmarterStats remote code execution attempt"; flow:to_client,established; content:"Server: SmarterTools"; content:!"Content-Type",within 150; isdataat:50; metadata:policy max-detect-ips drop; service:http; reference:cve,2011-2159; reference:url,xss.cx/examples/smarterstats-60-oscommandinjection-directorytraversal-xml-sqlinjection.html.html; classtype:web-application-attack; sid:48725; rev:3; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 9999 ( msg:"SERVER-WEBAPP SmarterStats remote code execution attempt"; flow:to_server,established; http_uri; content:"/Admin/Defaults/frmDefaultSiteSettings.aspx",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:http; reference:cve,2011-2159; reference:url,xss.cx/examples/smarterstats-60-oscommandinjection-directorytraversal-xml-sqlinjection.html.html; classtype:web-application-attack; sid:48726; rev:3; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 9999 ( msg:"SERVER-WEBAPP SmarterStats remote code execution attempt"; flow:to_server,established; http_uri; content:"/Admin/Defaults/frmServerDefaults.aspx",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:http; reference:cve,2011-2159; reference:url,xss.cx/examples/smarterstats-60-oscommandinjection-directorytraversal-xml-sqlinjection.html.html; classtype:web-application-attack; sid:48727; rev:3; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 9999 ( msg:"SERVER-WEBAPP SmarterStats remote code execution attempt"; flow:to_server,established; http_uri; content:"/Admin/frmReportSettings.aspx",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:http; reference:cve,2011-2159; reference:url,xss.cx/examples/smarterstats-60-oscommandinjection-directorytraversal-xml-sqlinjection.html.html; classtype:web-application-attack; sid:48728; rev:3; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 9999 ( msg:"SERVER-WEBAPP SmarterStats remote code execution attempt"; flow:to_server,established; http_uri; content:"/Admin/frmSite.aspx?SiteId=1&popup=true",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:http; reference:cve,2011-2159; reference:url,xss.cx/examples/smarterstats-60-oscommandinjection-directorytraversal-xml-sqlinjection.html.html; classtype:web-application-attack; sid:48729; rev:3; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 9999 ( msg:"SERVER-WEBAPP SmarterStats remote code execution attempt"; flow:to_server,established; http_uri; content:"/Client/frmImportSettings.aspx",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:http; reference:cve,2011-2159; reference:url,xss.cx/examples/smarterstats-60-oscommandinjection-directorytraversal-xml-sqlinjection.html.html; classtype:web-application-attack; sid:48730; rev:3; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 9999 ( msg:"SERVER-WEBAPP SmarterStats remote code execution attempt"; flow:to_server,established; http_uri; content:"/Client/frmSeoSettings.aspx",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:http; reference:cve,2011-2159; reference:url,xss.cx/examples/smarterstats-60-oscommandinjection-directorytraversal-xml-sqlinjection.html.html; classtype:web-application-attack; sid:48731; rev:3; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"SERVER-WEBAPP WP Statistics cross site scripting attempt"; flow:to_server,established; http_header; content:"Client-IP:",fast_pattern,nocase,nocase; pcre:"/^(X-Cluster-)?Client-IP\x3a[^\r\n]*?([\x3c\x3e]|script|onload|src)/im"; service:http; reference:url,pluginvulnerabilities.com/2019/07/05/sucuri-wpscan-and-others-incorrectly-claim-persistent-xss-vulnerability-in-wordpress-plugin-with-500000-installs-has-been-fixed/; classtype:attempted-user; sid:50876; rev:1; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"SERVER-WEBAPP WP Statistics cross site scripting attempt"; flow:to_server,established; http_header; content:"Forwarded:",fast_pattern,nocase,nocase; pcre:"/^(X-)?Forwarded\x3a[^\r\n]*?([\x3c\x3e]|script|onload|src)/im"; service:http; reference:url,pluginvulnerabilities.com/2019/07/05/sucuri-wpscan-and-others-incorrectly-claim-persistent-xss-vulnerability-in-wordpress-plugin-with-500000-installs-has-been-fixed/; classtype:attempted-user; sid:50877; rev:1; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"SERVER-WEBAPP WP Statistics cross site scripting attempt"; flow:to_server,established; http_header; content:"X-Real-IP:",fast_pattern,nocase,nocase; pcre:"/^X-Real-IP\x3a[^\r\n]*?([\x3c\x3e]|script|onload|src)/im"; service:http; reference:url,pluginvulnerabilities.com/2019/07/05/sucuri-wpscan-and-others-incorrectly-claim-persistent-xss-vulnerability-in-wordpress-plugin-with-500000-installs-has-been-fixed/; classtype:attempted-user; sid:50878; rev:1; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"SERVER-WEBAPP WP Statistics cross site scripting attempt"; flow:to_server,established; http_header; content:"Forwarded-For:",fast_pattern,nocase,nocase; pcre:"/^(X-)?Forwarded-For\x3a[^\r\n]*?([\x3c\x3e]|script|onload|src)/im"; service:http; reference:url,pluginvulnerabilities.com/2019/07/05/sucuri-wpscan-and-others-incorrectly-claim-persistent-xss-vulnerability-in-wordpress-plugin-with-500000-installs-has-been-fixed/; classtype:attempted-user; sid:50879; rev:1; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"SERVER-WEBAPP Asus RT-N10 Repeater Mode command injection attempt"; flow:to_client,established; file_data; content:"<iframe",nocase; content:"/apply.cgi",within 100,nocase; content:"SystemCmd=",within 250,fast_pattern,nocase; metadata:policy max-detect-ips drop; service:ftp-data, http, imap, pop3; reference:url,dl.packetstormsecurity.net/1910-exploits/asusrtn10-xssxsrfexec.txt; classtype:web-application-attack; sid:52328; rev:1; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"SERVER-WEBAPP Asus RT-N10 Repeater Mode command injection attempt"; flow:to_server,established; file_data; content:"<iframe",nocase; content:"/apply.cgi",within 100,nocase; content:"SystemCmd=",within 250,fast_pattern,nocase; metadata:policy max-detect-ips drop; service:smtp; reference:url,dl.packetstormsecurity.net/1910-exploits/asusrtn10-xssxsrfexec.txt; classtype:web-application-attack; sid:52329; rev:1; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"SQL IBM System Storage DS storage manager profiler sql injection attempt"; flow:to_server,established; http_uri; content:"ModuleServlet?DeviceId=1&state=state_viewmodulelog&selectedModuleOnly=1",fast_pattern; content:"&selectedModule=1",nocase; metadata:policy max-detect-ips drop,policy security-ips drop; service:http; reference:bugtraq,54112; reference:cve,2012-2171; reference:url,attack.mitre.org/techniques/T1190; reference:url,www.zeroscience.mk/codes/ibmssdssmp_sqlixss.txt; classtype:web-application-attack; sid:23947; rev:3; )
